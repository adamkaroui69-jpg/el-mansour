<Window x:Class="ElMansourSyndicManager.Views.LoginWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="El Mansour Syndic Manager - Connexion"
        Height="700" Width="1000"
        WindowStartupLocation="CenterScreen"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        KeyDown="Window_KeyDown"
        Icon="/Assets/logo.png">
    
    <Window.Resources>
        <Storyboard x:Key="FadeIn">
            <DoubleAnimation Storyboard.TargetProperty="Opacity" From="0" To="1" Duration="0:0:0.8">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.Y)" 
                             From="50" To="0" Duration="0:0:0.8">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
    </Window.Resources>
    
    <Window.Triggers>
        <EventTrigger RoutedEvent="Window.Loaded">
            <BeginStoryboard Storyboard="{StaticResource FadeIn}"/>
        </EventTrigger>
    </Window.Triggers>
    
    <!-- Fond Principal -->
    <Border CornerRadius="20" Background="{StaticResource AppBackgroundBrush}" ClipToBounds="True">
        <Grid>
            <!-- Éléments décoratifs d'arrière-plan (Glows) -->
            <Ellipse Width="600" Height="600" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,-200,-200,0">
                <Ellipse.Fill>
                    <RadialGradientBrush Center="0.5,0.5" GradientOrigin="0.5,0.5" RadiusX="0.5" RadiusY="0.5">
                        <GradientStop Color="#2C5282" Offset="0"/>
                        <GradientStop Color="#1A2332" Offset="1"/>
                    </RadialGradientBrush>
                </Ellipse.Fill>
                <Ellipse.Effect>
                    <BlurEffect Radius="100"/>
                </Ellipse.Effect>
            </Ellipse>
            
            <Ellipse Width="500" Height="500" HorizontalAlignment="Left" VerticalAlignment="Bottom" Margin="-100,0,0,-100">
                <Ellipse.Fill>
                    <RadialGradientBrush Center="0.5,0.5" GradientOrigin="0.5,0.5" RadiusX="0.5" RadiusY="0.5">
                        <GradientStop Color="#D4AF37" Offset="0"/>
                        <GradientStop Color="#1A2332" Offset="1"/>
                    </RadialGradientBrush>
                </Ellipse.Fill>
                <Ellipse.Effect>
                    <BlurEffect Radius="100"/>
                </Ellipse.Effect>
            </Ellipse>

            <!-- Bouton Fermer -->
            <Button Style="{StaticResource MaterialDesignIconButton}"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Top"
                    Margin="20"
                    Foreground="{StaticResource TextSecondaryBrush}"
                    Click="CloseButton_Click">
                <materialDesign:PackIcon Kind="Close" Width="24" Height="24"/>
            </Button>

            <!-- Contenu Central -->
            <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Carte de Connexion Glassmorphism -->
                <Border Grid.Row="1" Style="{StaticResource GlassCard}" Width="420" Padding="40">
                    <Border.RenderTransform>
                        <TranslateTransform/>
                    </Border.RenderTransform>
                    
                    <StackPanel>
                        <!-- Logo et Titre -->
                        <Image Source="/Assets/logo.png" Width="150" Height="150" Margin="0,0,0,20">
                            <Image.Effect>
                                <DropShadowEffect Color="#D4AF37" BlurRadius="30" ShadowDepth="0" Opacity="0.7"/>
                            </Image.Effect>
                        </Image>
                        
                        <TextBlock Text="Bienvenue"
                                 FontSize="28"
                                 FontWeight="Bold"
                                 Foreground="{StaticResource TextPrimaryBrush}"
                                 HorizontalAlignment="Center"
                                 Margin="0,0,0,5"/>
                        
                        <TextBlock Text="El Mansour Syndic Manager"
                                 FontSize="16"
                                 Foreground="{StaticResource TextSecondaryBrush}"
                                 HorizontalAlignment="Center"
                                 Margin="0,0,0,40"/>

                        <!-- Champs de saisie -->
                        <StackPanel Margin="0,0,0,20">
                            <TextBlock Text="CODE MAISON" 
                                     Foreground="{StaticResource TextSecondaryBrush}" 
                                     FontSize="12" 
                                     FontWeight="Bold" 
                                     Margin="0,0,0,8"/>
                            
                            <TextBox Style="{StaticResource ModernTextBox}"
                                     materialDesign:HintAssist.Hint="Ex: A01"
                                     Text="{Binding HouseCode, UpdateSourceTrigger=PropertyChanged}"/>
                        </StackPanel>

                        <StackPanel Margin="0,0,0,30">
                            <TextBlock Text="CODE PIN" 
                                     Foreground="{StaticResource TextSecondaryBrush}" 
                                     FontSize="12" 
                                     FontWeight="Bold" 
                                     Margin="0,0,0,8"/>
                            
                            <PasswordBox x:Name="PasswordBox"
                                       Style="{StaticResource ModernPasswordBox}"
                                       materialDesign:HintAssist.Hint="••••••"
                                       PasswordChanged="PasswordBox_PasswordChanged"/>
                        </StackPanel>

                        <!-- Bouton Connexion -->
                        <Button Style="{StaticResource ModernButton}"
                                Command="{Binding LoginCommand}"
                                Content="SE CONNECTER"
                                Margin="0,0,0,20">
                            <Button.Effect>
                                <DropShadowEffect Color="#3B82F6" BlurRadius="20" ShadowDepth="0" Opacity="0.4"/>
                            </Button.Effect>
                        </Button>

                        <!-- Message d'erreur -->
                        <Border Background="#20EF4444" 
                                CornerRadius="8" 
                                Padding="12"
                                Visibility="{Binding ErrorMessage, Converter={StaticResource StringToVisibilityConverter}}">
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                <materialDesign:PackIcon Kind="AlertCircle" 
                                                       Foreground="#EF4444"
                                                       VerticalAlignment="Center"
                                                       Margin="0,0,8,0"/>
                                <TextBlock Text="{Binding ErrorMessage}"
                                         Foreground="#EF4444"
                                         TextWrapping="Wrap"
                                         VerticalAlignment="Center"/>
                            </StackPanel>
                        </Border>

                        <!-- Loading -->
                        <ProgressBar IsIndeterminate="True"
                                   Height="4"
                                   Margin="0,20,0,0"
                                   Foreground="{StaticResource PrimaryBrush}"
                                   Visibility="{Binding IsLoading, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                    </StackPanel>
                </Border>
            </Grid>
        </Grid>
    </Border>
</Window>
